# =============================================================================
# TEN VAD STT 节点完整配置指南
# =============================================================================
# 此文件包含了所有可调参数的详细说明和推荐值
# 将需要的配置复制到你的 .env 文件中

# =============================================================================
# 核心 TEN VAD 参数
# =============================================================================

# TEN VAD 检测阈值 (0.0-1.0，默认0.5)
# 🎯 调整建议：
# - 安静环境/清晰语音: 0.3-0.4 (更敏感)
# - 嘈杂环境/会议室: 0.6-0.7 (更严格)
# - 极嘈杂环境/公交车: 0.7-0.8 (最严格)
TEN_VAD_THRESHOLD=0.5

# 最小语音帧数 - 确认语音开始所需的连续语音帧数
# 🎯 调整建议：
# - 快速响应: 3-4帧 (48-64ms)
# - 平衡设置: 5-6帧 (80-96ms) ✅ 推荐
# - 防误触发: 8-10帧 (128-160ms)
TEN_MIN_VOICE_FRAMES=5

# 最大静音帧数 - 确认语音结束的连续静音帧数
# 🎯 调整建议：
# - 快速切断: 20-30帧 (320-480ms)
# - 平衡设置: 40-50帧 (640-800ms) ✅ 推荐
# - 宽容模式: 60-80帧 (960-1280ms)
TEN_MAX_SILENCE_FRAMES=50

# 历史缓冲帧数 - 语音开始前包含的历史音频帧数
# 🎯 调整建议：
# - 短句优化: 15-20帧 (240-320ms)
# - 标准设置: 25-30帧 (400-480ms) ✅ 推荐
# - 完整捕获: 40-50帧 (640-800ms)
TEN_BUFFER_HISTORY_FRAMES=30

# =============================================================================
# 音频质量和过滤参数
# =============================================================================

# 最小音频能量阈值 (RMS值)
# 🎯 调整建议：
# - 高质量麦克风: 50-100
# - 标准麦克风: 100-200 ✅ 推荐
# - 低质量麦克风: 200-500
TEN_MIN_AUDIO_ENERGY=100

# 最短语音持续时间 (毫秒)
# 🎯 调整建议：
# - 允许短句: 200-250ms
# - 标准设置: 300-400ms ✅ 推荐
# - 只处理长句: 500-800ms
TEN_MIN_SPEECH_DURATION_MS=300

# =============================================================================
# STT 和语音识别参数
# =============================================================================

# OpenAI STT 模型
# gpt-4o-mini-transcribe: 最新最快 ✅ 推荐
# whisper-1: 传统Whisper模型
OPENAI_STT_MODEL=gpt-4o-mini-transcribe

# 音频采样率 (TEN VAD固定要求16kHz)
STT_SAMPLE_RATE=16000

# 音频帧大小 (TEN VAD默认256)
# 不建议修改，除非你了解影响
STT_CHUNK_SIZE=256

# =============================================================================
# 唤醒词和文本处理参数
# =============================================================================

# 唤醒词列表 (在代码中修改)
# 当前: ["hi captain", "hey captain", "hello captain"]

# 唤醒词相似度阈值 (0.0-1.0)
# 🎯 调整建议：
# - 严格匹配: 0.9-0.95
# - 标准设置: 0.85-0.88 ✅ 推荐  
# - 宽松匹配: 0.75-0.82
WAKE_WORD_SIMILARITY_THRESHOLD=0.86

# =============================================================================
# TTS 门控和交互参数
# =============================================================================

# TTS播放结束后的恢复等待时间 (秒)
# 🎯 调整建议：
# - 快速对话: 0.3-0.5s
# - 标准设置: 0.6-0.8s ✅ 推荐
# - 避免干扰: 1.0-1.5s
STT_RESUME_HANGOVER_SEC=0.8

# 是否允许在TTS播放期间打断
# 🎯 调整建议：
# - 自然对话: true
# - 避免干扰: false ✅ 推荐
STT_ALLOW_BARGE_IN=false

# TTS文本回放过滤过期时间 (秒)
# 防止识别出刚播放的TTS文本
TTS_ECHO_FILTER_DURATION=3.0

# =============================================================================
# 设备和硬件配置
# =============================================================================

# 音频输入设备名称匹配 (部分匹配)
# 例如: "USB", "Conference", "Blue Yeti" 等
STT_INPUT_DEVICE_NAME=

# 或者直接指定设备索引 (数字)
# 使用 arecord -l 查看可用设备
STT_INPUT_DEVICE_INDEX=

# 音频通道数
# 🎯 调整建议：
# - 单声道麦克风: 1 ✅ 推荐
# - 立体声麦克风: 2 (会自动混合为单声道)
STT_CHANNELS=1

# =============================================================================
# 性能监控和调试参数
# =============================================================================

# 性能统计输出间隔 (秒)
# 设为0禁用性能监控输出
PERFORMANCE_MONITOR_INTERVAL=30

# 详细调试日志
# 🎯 调整建议：
# - 生产环境: false ✅ 推荐
# - 调试问题: true
TEN_VAD_DEBUG_MODE=false

# =============================================================================
# 场景化配置模板
# =============================================================================

# 🏢 办公室/会议室环境 (中等噪音)
# TEN_VAD_THRESHOLD=0.6
# TEN_MIN_VOICE_FRAMES=6
# TEN_MAX_SILENCE_FRAMES=45
# TEN_MIN_AUDIO_ENERGY=150

# 🚌 公交车/高噪音环境
# TEN_VAD_THRESHOLD=0.7
# TEN_MIN_VOICE_FRAMES=8
# TEN_MAX_SILENCE_FRAMES=40
# TEN_MIN_AUDIO_ENERGY=300

# 🏠 安静家庭环境
# TEN_VAD_THRESHOLD=0.4
# TEN_MIN_VOICE_FRAMES=4
# TEN_MAX_SILENCE_FRAMES=60
# TEN_MIN_AUDIO_ENERGY=80

# 🎤 高质量录音室环境
# TEN_VAD_THRESHOLD=0.3
# TEN_MIN_VOICE_FRAMES=3
# TEN_MAX_SILENCE_FRAMES=70
# TEN_MIN_AUDIO_ENERGY=50

# =============================================================================
# 实时调整建议
# =============================================================================

# 如果遇到问题，按以下顺序调整：

# 1. 频繁误触发 (检测到噪音为语音)
#    → 增加 TEN_VAD_THRESHOLD (0.1-0.2)
#    → 增加 TEN_MIN_VOICE_FRAMES (2-3帧)
#    → 增加 TEN_MIN_AUDIO_ENERGY (50-100)

# 2. 语音检测不敏感 (漏检真实语音)
#    → 降低 TEN_VAD_THRESHOLD (0.1-0.2)
#    → 减少 TEN_MIN_VOICE_FRAMES (1-2帧)
#    → 降低 TEN_MIN_AUDIO_ENERGY (20-50)

# 3. 语音被过早切断
#    → 增加 TEN_MAX_SILENCE_FRAMES (10-20帧)
#    → 检查说话习惯，是否有长停顿

# 4. 响应太慢
#    → 减少 TEN_MAX_SILENCE_FRAMES (10-15帧)
#    → 减少 STT_RESUME_HANGOVER_SEC (0.2-0.3s)

# 5. 唤醒词识别率低
#    → 降低 WAKE_WORD_SIMILARITY_THRESHOLD (0.05-0.1)
#    → 增加 TEN_BUFFER_HISTORY_FRAMES (10-20帧)
#    → 检查发音是否清晰标准
